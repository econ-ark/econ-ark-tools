latex
\ProvidesPackage{econark-multibib}[2024/06/08 Supports system.bib and filename-Add-Refs.bib]

\RequirePackage{ifthen}
\RequirePackage{etoolbox}


\newcommand{\econarkmultibib}[1]{%
  \def\filename{#1}%
  
  \provideboolean{AddRefsExists}%
  \provideboolean{systemExists}%
  \provideboolean{filenameExists}%
  
  \IfFileExists{\filename-Add-Refs.bib}{%
    \setboolean{AddRefsExists}{true}%
  }{%
    \setboolean{AddRefsExists}{false}%
  }%
  
  \IfFileExists{system.bib}{%
    \setboolean{systemExists}{true}%
  }{%
    \setboolean{systemExists}{false}%
  }%
  
  \IfFileExists{\filename.bib}{%
    \setboolean{filenameExists}{true}%
  }{%
    \setboolean{filenameExists}{false}%
  }%
  
  \ifthenelse{\boolean{AddRefsExists}}{%
    \ifthenelse{\boolean{systemExists}}{%
      \ifthenelse{\boolean{filenameExists}}{%
        \typeout{econtex-multibib: References in \filename-Add-Refs.bib will take precedence over those elsewhere}%
        \typeout{econtex-multibib: References in default global system.bib will be used for items not found elsewhere}%
        \write\@auxout{\string\bibdata{\filename-Add-Refs,\filename,system}}%
      }{%
        \typeout{econtex-multibib: References in \filename-Add-Refs.bib will take precedence over those elsewhere}%
        \typeout{econtex-multibib: References in default global system.bib will be used for items not found elsewhere}%
        \typeout{econtex-multibib: Warning: \filename.bib not found}%
        \write\@auxout{\string\bibdata{\filename-Add-Refs,system}}%
      }%
    }{%
      \ifthenelse{\boolean{filenameExists}}{%
        \typeout{econtex-multibib: References in \filename-Add-Refs.bib will take precedence over those elsewhere}%
        \typeout{econtex-multibib: Found no global database file}%
        \write\@auxout{\string\bibdata{\filename-Add-Refs,\filename}}%
      }{%
        \typeout{econtex-multibib: References in \filename-Add-Refs.bib will take precedence over those elsewhere}%
        \typeout{econtex-multibib: Found no global database file}%
        \typeout{econtex-multibib: Warning: \filename.bib not found}%
        \write\@auxout{\string\bibdata{\filename-Add-Refs}}%
      }%
    }%
  }{%
    \ifthenelse{\boolean{systemExists}}{%
      \ifthenelse{\boolean{filenameExists}}{%
        \typeout{econtex-multibib: References in default global system.bib will be used for items not found elsewhere}%
        \write\@auxout{\string\bibdata{\filename,system}}%
      }{%
        \typeout{econtex-multibib: References in default global system.bib will be used for items not found elsewhere}%
        \typeout{econtex-multibib: Warning: \filename.bib not found}%
        \write\@auxout{\string\bibdata{system}}%
      }%
    }{%
      \ifthenelse{\boolean{filenameExists}}{%
        \typeout{econtex-multibib: Found no global database file}%
        \write\@auxout{\string\bibdata{\filename}}%
      }{%
        \typeout{econtex-multibib: Found no global database file}%
        \typeout{econtex-multibib: Warning: \filename.bib not found}%
        \typeout{econtex-multibib: No bibliography files found}%
      }%
    }%
  }%
}

\endinput
